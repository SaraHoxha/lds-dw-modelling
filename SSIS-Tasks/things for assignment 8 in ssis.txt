things for assignment 8 in ssis

QUESTION:

For each quarter, weather condition, and beat of occurrence, show the average ratio of people
under 21 years old to people over 21 years old involved in crashes

LOGIC:

For each of these: 

For each quarter (I have to agregate in quarters as ruggieri showed with views), for each weather condition (Already made in the table crash condition), for each beat of occurrence (Already made in the table crash location). 

CALCULATE:

AVERAGE ratio of (A/B) where ->
        A = People under 21 years old
        B = People over 21 years old


TABLES TO USE: 
CrashCondition.csv
CrashLocation.csv
Person.csv
dateTime.csv

Additional needs...
Crash.csv
DamageReimbursement.csv


Im working on a sql query do you think you can help me to generate it? I can pass the tables that should be used and the question and hand, also the logic on how I understand the problem and the attributes to use from each table.
